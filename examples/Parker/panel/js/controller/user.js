UserController=Module.controller("UserController",["$scope","$routeParams",function(e,t){function n(){t.hasUpdate&&(e.hasUpdate=!0,e.newVersion=t.new_version,e.downloadUrl=t.url),app.readFile(app.getConfigFile()).then(function(t){return e.user=JSON.parse(t),void 0==e.user.token?(app.showToast("登录过期, 请重新登录"),void e.logout()):(o(),void e.$apply())})}function o(){if(""!=e.user.licence)e.isAuthorized=!0;else{e.isAuthorized=!1;var t=1e3*e.user.trial_start,n=(new Date).getTime();n-t>1296e6?e.trialLeft=0:e.trialLeft=parseInt((t+1296e6-n)/864e5)}}e.user={},e.isAuthorized=!1,e.trialLeft=0,e.version=app.versionName,e.hasUpdate=!1,e.newVersion="0",e.downloadUrl="",e.buy=function(){app.openURL("http://www.cutterman.cn/parker")},e.back=function(){e.$emit("GO_PANEL")},e.download=function(){app.openURL(e.downloadUrl)},e.logout=function(){app.deleteFile(app.getConfigFile()).then(function(){return app.deleteFile(app.getLocalDir()+"/setting_v3.json")}).then(function(){e.$emit("LOGOUT_SUCCESS"),e.$apply()})},n()}]);